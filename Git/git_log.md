# Git 기초 - 커밋 히스토리 조회하기
```
210809 TIL #7
```
## ✔️ Git 커밋 히스토리 조회
Git에서 커밋 기록을 보고자 하는 경우 `git log` 명령을 사용한다. 새로 만들어서 몇 번 커밋을 했을 수도 있고, 커밋 히스토리가 있는 저장소를 `Clone`했을 수도 있다.

아래는 나의 TIL Git 저장소에 git log 명령어를 입력했을 때의 사진이다.
![image](https://user-images.githubusercontent.com/78305431/128635289-2d9f9da1-b108-47ee-bcda-ebd9aad5d235.png)

특별한 아규먼트 없이 실행하면 저장소의 커밋 히스토리를 시간순으로 보여준다. 가장 위에 나오는 내역이 가장 최근 내역임을 알 수 있다.

기록에는 SHA-1 체크섬, 저자 이름, 저자 이메일, 커밋 날짜와 시간, 커밋 메시지가 포함되 있다.

원하는 히스토리를 검색할 수 있도록 `git log` 명령은 매우 다양한 옵션을 지원한다. 그 중 자주 사용하는 옵션을 설명하고자 한다.

## ❓ git log escape
로그 메시지를 모두 출력하기 때문에 필요한 부분까지 확인 후 탈출할 수 있다. 

`Q키`를 누르면 로그 화면을 탈출한다.

***
## ✔️ git log 명령어 옵션
Git bash에서 내용이 길면 출력 내용이 잘릴 수 있는데 콘솔 하단에 :(콜론)이 표시된 상태에서 `space bar`를 누르면 모두 출력된다.

### **-p**
각 커밋의 `diff` 결과를 보여준다. 이 옵션은 직접 diff를 실행한 것과 같은 결과를 출력하기 때문에 동료가 무엇을 커밋했는지 리뷰하고 빨리 조회하는데 유용하다. 

### **-[숫자]**
숫자 옵션은 `-2`와 같이 사용하며, 최근 몇개의 내역을 보여줄 것인지를 지정하는 것이다.

최근 두 개의 커밋을 diff결과까지 보기 위해서 다음과 같이 사용한다.
![image](https://user-images.githubusercontent.com/78305431/128635652-8055194b-fabf-4734-ab2a-933462a02b3d.png)

### **--stat**
각 커밋의 통계 정보를 조회할 수 있다. 어떤 파일이 수정됐는지, 얼마나 많은 파일이 변경됐는지, 또 얼마나 많은 라인을 추가하거나 삭제했는지 보여준다. 요약정보는 가장 뒤쪽에 보여준다.

![image](https://user-images.githubusercontent.com/78305431/128635808-b943139f-4700-48c9-a994-4f2d0fe7302f.png)

### **--pretty**
`--pretty` 옵션과 부가 옵션을 추가로 사용하면 기본 형식 이외의 다양한 형식으로 기록을 볼 수 있다. `oneline` 옵션은 하나의 커밋을 커밋 체크섬과 커밋 메시지만을 가지고 한 줄로만 표현해 주며 `short, full, fuller` 옵션은 각각 단계에 따라 정보들을 추가적으로 자세히 보여준다.

![image](https://user-images.githubusercontent.com/78305431/128636008-958218f3-fd86-497e-a1a1-46f8d5a0e56e.png)

`format` 옵션을 사용해 나만의 포맷으로 결과를 출력할 수도 있다. 특히 결과를 다른 프로그램으로 파싱하고자 할 때 유용하다. 이 옵션을 사용하면 포맷을 정확하게 일치시킬 수 있기 때문에 Git을 새 버전으로 바꿔도 결과 포맷이 바뀌지 않는다. 
![image](https://user-images.githubusercontent.com/78305431/128636133-7c3811d8-a77b-48ad-a3a7-9348cdc9f6d8.png)

[표. `git log --pretty=format` 에 쓸 몇가지 유용한 옵션]
<figure>
    <table>
        <thead>
            <tr>
                <th>옵션</th>
                <th>설명</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>%H</td>
                <td>커밋 해시</td>
            </tr>
            <tr>
                <td>%h</td>
                <td>짧은 길이 커밋 해시</td>
            </tr>
            <tr>
                <td>%T</td>
                <td>트리 해시</td>
            </tr>
            <tr>
                <td>%t</td>
                <td>짧은 길이 트리 해시</td>
            </tr>
            <tr>
                <td>%p</td>
                <td>짧은 길이 부모 해시</td>
            </tr>
            <tr>
                <td>%an</td>
                <td>저자 이름</td>
            </tr>
            <tr>
                <td>%ae</td>
                <td>저자 메일</td>
            </tr>
            <tr>
                <td>%ad</td>
                <td>저자 시각(형식은 -date 옵션)</td>
            </tr>
            <tr>
                <td>%ar</td>
                <td>저자 상대적 시각(ex: 5 days ago)</td>
            </tr>
            <tr>
                <td>%cn</td>
                <td>committer 이름(커밋한 사람)</td>
            </tr>
            <tr>
                <td>%ce</td>
                <td>committer 메일</td>
            </tr>
            <tr>
                <td>%cd</td>
                <td>committer 시간</td>
            </tr>
            <tr>
                <td>%cr</td>
                <td>committer 상대 시간</td>
            </tr>
            <tr>
                <td>%s</td>
                <td>요약</td>
            </tr>
        </tbody>
    </table>
</figure>

## ❓ 저자(Author)와 커미터(Committer)
저자의 경우는 실제 작업을 수행한 원작자이고 커밋터는 실제 저장소에 커밋한 사람이다. 

만약 내가 어떤 프로젝트에 패치를 보냈고 그 프로젝트의 담당자가 패치를 적용했다면 두 명의 정보를 모두 알 필요가 있다. 그래서 이 경우 내가 저자고 그 담당자가 커미터이다.

`oneline` 옵션과 `format` 옵션은 `--graph` 옵션과 사용할 때 더욱 편리하다. 이 명령은 브랜치와 머지 히스토리를 보여주는 아스키 그래프를 출력한다. 

### **조건 범위로 조회**
`git log`의 몇가지 옵션을 통해 조건을 주어 일부분의 커밋 기록만을 조회할 수 있다. 나중에 커밋이 몇 만개가 된다면 모든 기록을 출력하여 보면 원하는 정보를 뽑아내기 힘들므로 원하는 정보를 보다 빠르게 캐치하기 위해서는 조건 범위 검색 옵션이 유용하다.

최근 두 개만 조회하는 `-[숫자]`옵션은 살펴봤다. 최근 n개의 커밋을 조회할 수 있다. 사실 이 옵션은 자주 쓰진 않는다. Git은 기본적으로 출력을 pager류의 프로그램을 거쳐서 내보내므로 한 번에 한 페이지씩 보여준다.

반면 `--since`와 `-until` 같이 시간을 기준으로 하는 옵션을 이용하여 특정 날짜를 지정하는 기능은 유용하다.

지난 2일 동안 만들어진 커밋을 조회하는 명령은 다음과 같다.

![image](https://user-images.githubusercontent.com/78305431/128636657-a8f24346-031c-4040-aa0b-34e2abe536d3.png)

예를 들어 `2021-08-09` 와 같이 지정하거나, `1 years 1 day 3 minutes ago`와 같은 상대적인 시간으로도 지정이 가능하다.

또 따른 기준도 있다. `--author` 옵션으로 저자를 지정하거나 `--commiter` 옵션으로 커밋터를 지정하여 검색할 수도 있고 `--grep` 옵션으로 커밋 메시지에서 키워드를 검색할 수도 있다. 이 둘을 모두 만족하는 커밋을 찾으려면 `--all-match` 옵션을 사용한다.

### **-S**
코드에서 추가되거나 제거된 내용 중에 특정 텍스트가 포함되어 있는지를 검색한다. 예를 들어 어떤 함수가 추가되거나 제거된 커밋만을 찾아보려면 아래와 같은 명령을 사용한다.
```
$ git log -S function_name
```

마지막으로 파일 경로를 검색하는 옵션이 있다. 디렉토리나 파일 이름을 사용하여 그 파일이 변경된 log의 결과를 검색할 수 있다. 이 옵션은 `--`와 함께 경로 이름을 사용하는데 명령어 끝 부분에 쓴다.
```
$ git log -path1-path2
```
***
참고 - https://codeomni.tistory.com/466

https://dololak.tistory.com/338

https://git-scm.com/book/ko/v2/Git%EC%9D%98-%EA%B8%B0%EC%B4%88-%EC%BB%A4%EB%B0%8B-%ED%9E%88%EC%8A%A4%ED%86%A0%EB%A6%AC-%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0